---
title: ä¸€åˆ†é’Ÿæ•™ä½ å‘å¸ƒnpmåŒ…
author: çŒ¿è¯
authorURL: https://mp.weixin.qq.com/s/ud0tzSNfooZyx6SMODw9aw
# authorFBID: 100002976521003
---

## å‰è¨€

- æ‘˜è¦ï¼šä»€ä¹ˆæ˜¯npm?
- å¦‚ä½•å‘å¸ƒä¸€ä¸ªè‡ªå·±çš„npmåŒ…
- å‘å¸ƒé”™è¯¯é›†é”¦

## **æ‘˜è¦ï¼šä»€ä¹ˆæ˜¯npm?**

npmæ˜¯javascriptè‘—åçš„**åŒ…ç®¡ç†å·¥å…·**ï¼Œæ˜¯**å‰ç«¯æ¨¡å—åŒ–**ä¸‹çš„ä¸€ä¸ªæ ‡å¿—æ€§äº§ç‰©
ç®€å•åœ°åœ°è¯´ï¼Œå°±æ˜¯**é€šè¿‡npmä¸‹è½½æ¨¡å—ï¼Œå¤ç”¨å·²æœ‰çš„ä»£ç ï¼Œæé«˜å·¥ä½œæ•ˆç‡**
å’Œç§»åŠ¨ç«¯å¼€å‘ä¸­ï¼ŒiOSä½¿ç”¨çš„Cocoapodsï¼ŒAndroidä½¿ç”¨çš„mavenæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚


<!--truncate-->

## **å¦‚ä½•å‘å¸ƒä¸€ä¸ªè‡ªå·±çš„npmåŒ…**

### **1ã€åˆ›å»ºä¸€ä¸ªnpmçš„è´¦å·**

å‘å¸ƒåŒ…ä¹‹å‰ä½ å¿…é¡»è¦æ³¨å†Œä¸€ä¸ªnpmçš„è´¦å·

### **2ã€åˆå§‹åŒ–ä¸€ä¸ªç®€å•çš„é¡¹ç›®å‘å¸ƒ**

aã€æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š**ä¾‹å¦‚ï¼šz-tool**
bã€æ‰§è¡Œå‘½ä»¤è¿›å…¥ç›®å½•:   **$ cd z-tool** 
cã€æ‰§è¡Œ**npm init** åˆå§‹åŒ–é¡¹ç›®ã€‚é»˜è®¤ä¸€è·¯å›è½¦å°±è¡Œ

```shell
sh-neverleave:z-tool neverleave$ npm init

This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.

See `npm help json` for definitive documentation on these fields
and exactly what they do.

Use `npm install <pkg>` afterwards to install a package and
save it as a dependency in the package.json file.

Press ^C at any time to quit.
package name: (z-tool) 
version: (1.0.0) 
description: 
entry point: (index.js) 
test command: 
git repository: 
keywords: 
author: 
license: (ISC) 
About to write to /Users/neverleave/Desktop/z-tool/package.json:

{
  "name": "z-tool",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}

Is this ok? (yes) 

```

``` js
é»˜è®¤å­—æ®µç®€ä»‹ï¼š
nameï¼šå‘å¸ƒçš„åŒ…åï¼Œé»˜è®¤æ˜¯ä¸Šçº§æ–‡ä»¶å¤¹åã€‚ä¸å¾—ä¸ç°åœ¨npmä¸­çš„åŒ…åé‡å¤ã€‚åŒ…åä¸èƒ½æœ‰å¤§å†™å­—æ¯/ç©ºæ ¼/ä¸‹æ»‘çº¿!
versionï¼šä½ è¿™ä¸ªåŒ…çš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯1.0.0ã€‚å¯¹äºnpmåŒ…çš„ç‰ˆæœ¬å·æœ‰ç€ä¸€ç³»åˆ—çš„è§„åˆ™ï¼Œæ¨¡å—çš„ç‰ˆæœ¬å·é‡‡ç”¨X.Y.Zçš„æ ¼å¼ï¼Œå…·ä½“ä½“ç°ä¸ºï¼š
  1ã€ä¿®å¤bugï¼Œå°æ”¹åŠ¨ï¼Œå¢åŠ zã€‚
  2ã€å¢åŠ æ–°ç‰¹æ€§ï¼Œå¯å‘åå…¼å®¹ï¼Œå¢åŠ y
  3ã€æœ‰å¾ˆå¤§çš„æ”¹åŠ¨ï¼Œæ— æ³•å‘ä¸‹å…¼å®¹,å¢åŠ x
descriptionï¼šé¡¹ç›®ç®€ä»‹
mianï¼šå…¥å£æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯Index.jsï¼Œå¯ä»¥ä¿®æ”¹æˆè‡ªå·±çš„æ–‡ä»¶ 
scriptsï¼šåŒ…å«å„ç§è„šæœ¬æ‰§è¡Œå‘½ä»¤
testï¼šæµ‹è¯•å‘½ä»¤ã€‚
authorï¼šå†™è‡ªå·±çš„è´¦å·å
licenseï¼šè¿™ä¸ªç›´æ¥å›è½¦ï¼Œå¼€æºæ–‡ä»¶åè®®å§ï¼Œä¹Ÿå¯ä»¥æ˜¯MITï¼Œçœ‹éœ€è¦å§ã€‚
```
dã€åœ¨z-toolæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸ºindex.jsçš„æ–‡ä»¶ï¼Œç®€å•çš„å†™äº†ä¸€ä¸‹å†…å®¹ã€‚
```
!function(){
  console.log(`è¿™æ˜¯å¼•å…¥çš„åŒ…å…¥å£`)
}()
```

### **3ã€å¦‚æœæœ¬æœºç¬¬ä¸€æ¬¡å‘å¸ƒåŒ…ï¼ˆéç¬¬ä¸€æ¬¡å¯å¿½ç•¥ï¼‰**
åœ¨ç»ˆç«¯è¾“å…¥npm adduserï¼Œæç¤ºè¾“å…¥è´¦å·ï¼Œå¯†ç å’Œé‚®ç®±ï¼Œç„¶åå°†æç¤ºåˆ›å»ºæˆåŠŸï¼Œå…·ä½“å¦‚ä¸‹å›¾ã€‚
ã€æ³¨æ„ã€‘npm adduseræˆåŠŸçš„æ—¶å€™é»˜è®¤ä½ å·²ç»ç™»é™†äº†ï¼Œæ‰€ä»¥å¯è·³è¿‡ç¬¬å››æ­¥ã€‚

![npm adduser æ‰§è¡Œç»“æœ](https://upload-images.jianshu.io/upload_images/3899173-5bd8426c17bed88c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æœ€åä¸€è¡Œæ˜¾ç¤ºç™»å½•ä¿¡æ¯ï¼Œas åé¢æ˜¯ç”¨æˆ·åã€‚on åæ˜¯æºåœ°å€ï¼Œå¦‚æœä¸æ˜¯https://registry.npmjs.org/ï¼Œæ¯”å¦‚æ˜¯æ·˜å®æºï¼Œè¯·åˆ‡æ¢ã€‚å¯ä»¥å‚è€ƒï¼šhttps://segmentfault.com/a/1190000004444283

![](https://upload-images.jianshu.io/upload_images/3899173-a0eb9d326617594b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### **4ã€éç¬¬ä¸€æ¬¡å‘å¸ƒåŒ…**

åœ¨ç»ˆç«¯è¾“å…¥npm loginï¼Œç„¶åè¾“å…¥ä½ åˆ›å»ºçš„è´¦å·å’Œå¯†ç ï¼Œå’Œé‚®ç®±ï¼Œç™»é™†ï¼Œç»“æœåŒæ­¥éª¤ä¸‰ã€‚

### **5ã€npm publish å‘åŒ…**
æˆåŠŸå‘å¸ƒï¼š
```
sh-neverleave:z-tool neverleave$ npm publish
+ z-tool@1.0.1
```

**æ³¨æ„**ï¼šå¦‚æœé¡¹ç›®é‡Œæœ‰éƒ¨åˆ†ç§å¯†çš„ä»£ç ä¸æƒ³å‘å¸ƒåˆ°npmä¸Šï¼Œå¯ä»¥å°†å®ƒå†™å…¥.gitignore æˆ–.npmignoreä¸­ï¼Œä¸Šä¼ å°±ä¼šè¢«å¿½ç•¥äº†

### **6ã€æŸ¥è¯¢å‘å¸ƒçš„åŒ…**

åˆ°npmå®˜ç½‘å…¨å±€æœç´¢å³å¯

### **7ã€å®‰è£…ä½¿ç”¨æ–¹å¼**

å’Œå…¶ä»–åŒ…ä½¿ç”¨æ–¹å¼ä¸€è‡´ï¼Œå…·ä½“ä½¿ç”¨å¯ä»¥çœ‹**æºç ä»‹ç»**æˆ–è€…**README.md**ã€‚

### **8ã€å¦‚ä½•æ’¤é”€å‘å¸ƒçš„åŒ…**

ç»ˆç«¯æ‰§è¡Œ npm unpublish
ä¾‹å¦‚ï¼š
1ã€npm unpublish z-tool@1.0.0   åˆ é™¤æŸä¸ªç‰ˆæœ¬
2ã€npm unpublish z-tool --force   åˆ é™¤æ•´ä¸ªnpmå¸‚åœºçš„åŒ…

ä¸è¿‡æ’¤åŒ…æ¨èç”¨æ³•ï¼š
npm unpublishçš„æ¨èæ›¿ä»£å‘½ä»¤ï¼šnpm deprecate <pkg>[@<version>] <message>
ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸ä¼šåœ¨ç¤¾åŒºé‡Œæ’¤é”€ä½ å·²æœ‰çš„åŒ…ï¼Œä½†ä¼šåœ¨ä»»ä½•äººå°è¯•å®‰è£…è¿™ä¸ªåŒ…çš„æ—¶å€™å¾—åˆ°è­¦å‘Š
ä¾‹å¦‚ï¼šnpm deprecate z-tool  'è¿™ä¸ªåŒ…æˆ‘å·²ç»ä¸å†ç»´æŠ¤äº†å“Ÿï½'

ã€æ³¨æ„ã€‘å¦‚æœæŠ¥æƒé™æ–¹é¢çš„é”™ï¼ŒåŠ ä¸Š--force

## **å‘å¸ƒé”™è¯¯é›†é”¦**
1ã€éœ€è¦æé«˜ç‰ˆæœ¬å·
```shell
#1ã€å‘åŒ… npm publish å¤±è´¥
sh-neverleave:z-tool neverleave$ npm publish
npm ERR! publish Failed PUT 400
npm ERR! code E400
npm ERR! deprecations must be strings : z-tool

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T10_52_01_742Z-debug.log
sh-neverleave:z-tool neverleave$ npm publish


#2ã€å‘åŒ… npm publish å¤±è´¥
sh-neverleave:z-tool neverleave$ npm publish
npm ERR! publish Failed PUT 403
npm ERR! code E403
npm ERR! You cannot publish over the previously published versions: 1.0.3. : z-tool

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T11_24_57_662Z-debug.log
sh-neverleave:z-tool neverleave$ 

```
2ã€å‘åŒ… npm publish å¤±è´¥
 è§£å†³æ–¹æ¡ˆï¼šç»ˆç«¯æ‰§è¡Œï¼š npm publish --access public

å‚è€ƒï¼šhttps://stackoverflow.com/questions/53420758/npm-publish-gives-unscoped-packages-cannot-be-private
```
#1ã€å‘åŒ… npm publish å¤±è´¥
sh-neverleave:npm neverleave$ npm publish
npm ERR! publish Failed PUT 400
npm ERR! code E400
npm ERR! unscoped packages cannot be private : z-tool

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T08_44_21_310Z-debug.log
sh-neverleave:npm neverleave$ 

#è§£å†³æ–¹æ¡ˆï¼šç»ˆç«¯æ‰§è¡Œï¼š npm publish --access public
sh-neverleave:npm neverleave$ npm publish --access public
+ z-tool@1.0.0
sh-neverleave:npm neverleave$ 
```
3ã€ç¡®ä¿ç™»å½•çš„ç”¨æˆ·è´¦å·æ­£ç¡®

```
sh-neverleave:npm neverleave$ npm publish
npm ERR! publish Failed PUT 404
npm ERR! code E404
npm ERR! 404 User not found : z-tool
npm ERR! 404 
npm ERR! 404  'z-tool' is not in the npm registry.
npm ERR! 404 You should bug the author to publish it (or use the name yourself!)
npm ERR! 404 
npm ERR! 404 Note that you can also install from a
npm ERR! 404 tarball, folder, http url, or git url.

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T07_32_28_518Z-debug.log
```
4ã€ç™»å½•æ—¶éœ€è¦åœ¨username å‰åŠ â€˜~â€™ï¼Œå…·ä½“å¤§å®¶å¯ä»¥éªŒè¯
```
sh-neverleave:npm neverleave$ npm login
Username: (~neverleave) neverleave
Password: (<default hidden>) 
Email: (this IS public) (1063588359@qq.com) 
npm ERR! code EAUTHIP
npm ERR! Unable to authenticate, need: Basic

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T07_27_50_877Z-debug.log
sh-neverleave:npm neverleave$ 
```
5ã€æ— æƒé™åˆ é™¤çº¿ä¸Šçš„åŒ…ï¼ˆæ’¤åŒ…æœ‰æ—¶é—´é™åˆ¶ï¼Œ24å°æ—¶ï¼‰
è§£å†³æ–¹æ¡ˆï¼šåŠ ä¸Š --force
```
sh-neverleave:z-tool neverleave$ npm unpublish z-tool
npm ERR! Refusing to delete entire project.
npm ERR! Run with --force to do this.
npm ERR! npm unpublish [<@scope>/]<pkg>[@<version>]
sh-neverleave:z-tool neverleave$ 

#è§£å†³æ–¹æ¡ˆï¼ˆå†…éƒ¨æœ‰è¢«é„™è§†çš„è¯ï¼ŒğŸ˜„ I sure hope you know what you are doing.ï¼‰
sh-neverleave:z-tool neverleave$ npm unpublish z-tool --force
npm WARN using --force I sure hope you know what you are doing.
- z-tool
sh-neverleave:z-tool neverleave$ 
```

6ã€åˆ é™¤npmå¸‚åœºçš„åŒ…åŒåçš„24å°æ—¶åæ‰èƒ½é‡æ–°å‘å¸ƒ
```
sh-neverleave:z-tool neverleave$ npm publish
npm ERR! publish Failed PUT 403
npm ERR! code E403
npm ERR! z-tool cannot be republished until 24 hours have passed. : z-tool

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/neverleave/.npm/_logs/2018-11-23T11_41_24_086Z-debug.log
sh-neverleave:z-tool neverleave$ 
```

å®Œç»“


![å…³æ³¨å¾®ä¿¡å…¬ä¼—å·](https://upload-images.jianshu.io/upload_images/3899173-41ee2db16052ed9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)